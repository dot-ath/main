import{r as P,R as it}from"./index.03be2d59.js";import{a as Cr,j as V,e as Rr}from"./jsx-runtime.fa3cf36c.js";function Er(t){return t}function xr(t){return t.length===0?Er:t.length===1?t[0]:function(r){return t.reduce((n,s)=>s(n),r)}}function Ge(t){const e={subscribe(r){let n=null,s=!1,i=!1,u=!1;function o(){if(n===null){u=!0;return}i||(i=!0,typeof n=="function"?n():n&&n.unsubscribe())}return n=t({next(a){s||r.next?.(a)},error(a){s||(s=!0,r.error?.(a),o())},complete(){s||(s=!0,r.complete?.(),o())}}),u&&o(),{unsubscribe:o}},pipe(...r){return xr(r)(e)}};return e}function Qr(t){return e=>{let r=0,n=null;const s=[];function i(){n||(n=e.subscribe({next(o){for(const a of s)a.next?.(o)},error(o){for(const a of s)a.error?.(o)},complete(){for(const o of s)o.complete?.()}}))}function u(){if(r===0&&n){const o=n;n=null,o.unsubscribe()}}return{subscribe(o){return r++,s.push(o),i(),{unsubscribe(){r--,u();const a=s.findIndex(c=>c===o);a>-1&&s.splice(a,1)}}}}}}function qr(t){return e=>({subscribe(r){return e.subscribe({next(n){t.next?.(n),r.next?.(n)},error(n){t.error?.(n),r.error?.(n)},complete(){t.complete?.(),r.complete?.()}})}})}class Xe extends Error{constructor(e){super(e),this.name="ObservableAbortError",Object.setPrototypeOf(this,Xe.prototype)}}function Ir(t){let e;return{promise:new Promise((n,s)=>{let i=!1;function u(){i||(i=!0,s(new Xe("This operation was aborted.")),o.unsubscribe())}const o=t.subscribe({next(a){i=!0,n(a),u()},error(a){i=!0,s(a),u()},complete(){i=!0,u()}});e=u}),abort:e}}function Qe(t){return!!t&&!Array.isArray(t)&&typeof t=="object"}class T extends Error{static from(e,r={}){return e instanceof Error?e.name==="TRPCClientError"?e:new T(e.message,{...r,cause:e,result:null}):new T(e.error.message??"",{...r,cause:void 0,result:e})}constructor(e,r){const n=r?.cause;super(e,{cause:n}),this.meta=r?.meta,this.cause=n,this.shape=r?.result?.error,this.data=r?.result?.error.data,this.name="TRPCClientError",Object.setPrototypeOf(this,T.prototype)}}function Ar(t,e){if("error"in t){const n=e.transformer.deserialize(t.error);return{ok:!1,error:{...t,error:n}}}return{ok:!0,result:{...t.result,...(!t.result.type||t.result.type==="data")&&{type:"data",data:e.transformer.deserialize(t.result.data)}}}}function Tr(t,e){let r;try{r=Ar(t,e)}catch{throw new T("Unable to transform response from server")}if(!r.ok&&(!Qe(r.error.error)||typeof r.error.error.code!="number"))throw new T("Badly formatted response from server");if(r.ok&&!Qe(r.result))throw new T("Badly formatted response from server");return r}function Mr(t){return Ge(e=>{function r(s=0,i=t.op){const u=t.links[s];if(!u)throw new Error("No more links to execute - did you forget to add an ending link?");return u({op:i,next(a){return r(s+1,a)}})}return r().subscribe(e)})}const Tt=()=>{};function Mt(t,e){return new Proxy(Tt,{get(n,s){if(!(typeof s!="string"||s==="then"))return Mt(t,[...e,s])},apply(n,s,i){return t({args:i,path:e})}})}const ge=t=>Mt(t,[]),Ye=t=>new Proxy(Tt,{get(e,r){if(!(typeof r!="string"||r==="then"))return t(r)}}),Dr={query:["72e3ff","3fb0d8"],mutation:["c5a3fc","904dfc"],subscription:["ff49e1","d83fbe"]};function Fr(t){return typeof FormData>"u"?!1:t instanceof FormData}const kr=(t=console)=>e=>{const{direction:r,type:n,path:s,context:i,id:u}=e,[o,a]=Dr[n],c=e.input,l=Qe(c)&&Fr(c)?Object.fromEntries(c):e.input,d=`
    background-color: #${r==="up"?o:a}; 
    color: ${r==="up"?"black":"white"};
    padding: 2px;
  `,p=["%c",r==="up"?">>":"<<",n,`#${u}`,`%c${s}%c`,"%O"],f=[d,`${d}; font-weight: bold;`,`${d}; font-weight: normal;`];e.direction==="up"?f.push({input:l,context:i}):f.push({input:l,result:e.result,elapsedMs:e.elapsedMs,context:i});const h=e.direction==="down"&&e.result&&(e.result instanceof Error||"error"in e.result.result)?"error":"log";t[h].apply(null,[p.join(" ")].concat(f))};function _r(t={}){const{enabled:e=()=>!0}=t,{logger:r=kr(t.console)}=t;return()=>({op:n,next:s})=>Ge(i=>{e({...n,direction:"up"})&&r({...n,direction:"up"});const u=Date.now();function o(a){const c=Date.now()-u;e({...n,direction:"down",result:a})&&r({...n,direction:"down",elapsedMs:c,result:a})}return s(n).pipe(qr({next(a){o(a)},error(a){o(a)}})).subscribe(i)})}/* istanbul ignore next -- @preserve */const Ur=t=>t===0?0:Math.min(1e3*2**t,3e4);function jr(t){const{url:e,WebSocket:r=WebSocket,retryDelayMs:n=Ur,onOpen:s,onClose:i}=t;/* istanbul ignore next -- @preserve */if(!r)throw new Error("No WebSocket implementation found - you probably don't want to use this on the server, but if you do you need to pass a `WebSocket`-ponyfill");let u=[];const o=Object.create(null);let a=0,c=null,l=null,d=S(),p="connecting";function f(){p!=="open"||c||(c=setTimeout(()=>{c=null,u.length===1?d.send(JSON.stringify(u.pop())):d.send(JSON.stringify(u)),u=[]}))}function h(){if(l||p==="closed")return;const g=n(a++);b(g)}function v(){p="connecting";const g=d;d=S(),m(g)}function b(g){l||(p="connecting",l=setTimeout(v,g))}function m(g){Object.values(o).some(w=>w.ws===g)||g.close()}function E(g){u.some(y=>y.id===g.op.id)||C(g.op,g.callbacks)}function S(){const g=typeof e=="function"?e():e,y=new r(g);clearTimeout(l),l=null,y.addEventListener("open",()=>{/* istanbul ignore next -- @preserve */y===d&&(a=0,p="open",s?.(),f())}),y.addEventListener("error",()=>{y===d&&h()});const w=x=>{if(x.method==="reconnect"&&y===d){p==="open"&&i?.(),v();for(const R of Object.values(o))R.type==="subscription"&&E(R)}},O=x=>{const R=x.id!==null&&o[x.id];if(R){if(R.callbacks.next?.(x),R.ws!==d&&y===d){const I=R.ws;R.ws=d,m(I)}"result"in x&&x.result.type==="stopped"&&y===d&&R.callbacks.complete()}};return y.addEventListener("message",({data:x})=>{const R=JSON.parse(x);"method"in R?w(R):O(R),(y!==d||p==="closed")&&m(y)}),y.addEventListener("close",({code:x})=>{p==="open"&&i?.({code:x}),d===y&&h();for(const[R,I]of Object.entries(o))if(I.ws===y){if(p==="closed"){delete o[R],I.callbacks.complete?.();continue}I.type==="subscription"?E(I):(delete o[R],I.callbacks.error?.(T.from(new Ze("WebSocket closed prematurely"))))}}),y}function C(g,y){const{type:w,input:O,path:x,id:R}=g,I={id:R,method:w,params:{input:O,path:x}};return o[R]={ws:d,type:w,callbacks:y,op:g},u.push(I),f(),()=>{const ce=o[R]?.callbacks;delete o[R],u=u.filter(Se=>Se.id!==R),ce?.complete?.(),d.readyState===r.OPEN&&g.type==="subscription"&&(u.push({id:R,method:"subscription.stop"}),f())}}return{close:()=>{p="closed",i?.(),m(d),clearTimeout(l),l=null},request:C,getConnection(){return d}}}class Ze extends Error{constructor(e){super(e),this.name="TRPCWebSocketClosedError",Object.setPrototypeOf(this,Ze.prototype)}}class Je extends Error{constructor(e){super(e),this.name="TRPCSubscriptionEndedError",Object.setPrototypeOf(this,Je.prototype)}}function Kr(t){return e=>{const{client:r}=t;return({op:n})=>Ge(s=>{const{type:i,path:u,id:o,context:a}=n,c=e.transformer.serialize(n.input);let l=!1;const d=r.request({type:i,path:u,input:c,id:o,context:a},{error(p){l=!0,s.error(p),d()},complete(){l?s.complete():(l=!0,s.error(T.from(new Je("Operation ended prematurely"))))},next(p){const f=Tr(p,e);if(!f.ok){s.error(T.from(f.error));return}s.next({result:f.result}),n.type!=="subscription"&&(l=!0,d(),s.complete())}});return()=>{l=!0,d()}})}}class Nr{$request({type:e,input:r,path:n,context:s={}}){return Mr({links:this.links,op:{id:++this.requestId,type:e,path:n,input:r,context:s}}).pipe(Qr())}requestAsPromise(e){const r=this.$request(e),{promise:n,abort:s}=Ir(r);return new Promise((u,o)=>{e.signal?.addEventListener("abort",s),n.then(a=>{u(a.result.data)}).catch(a=>{o(T.from(a))})})}query(e,r,n){return this.requestAsPromise({type:"query",path:e,input:r,context:n?.context,signal:n?.signal})}mutation(e,r,n){return this.requestAsPromise({type:"mutation",path:e,input:r,context:n?.context,signal:n?.signal})}subscription(e,r,n){return this.$request({type:"subscription",path:e,input:r,context:n?.context}).subscribe({next(i){i.result.type==="started"?n.onStarted?.():i.result.type==="stopped"?n.onStopped?.():n.onData?.(i.result.data)},error(i){n.onError?.(i)},complete(){n.onComplete?.()}})}constructor(e){this.requestId=0;const r=(()=>{const n=e.transformer;return n?"input"in n?e.transformer:{input:n,output:n}:{input:{serialize:s=>s,deserialize:s=>s},output:{serialize:s=>s,deserialize:s=>s}}})();this.runtime={transformer:{serialize:n=>r.input.serialize(n),deserialize:n=>r.output.deserialize(n)},combinedTransformer:r},this.links=e.links.map(n=>n(this.runtime))}}function Lr(t){return new Nr(t)}const Br={query:"query",mutate:"mutation",subscribe:"subscription"};function $r(t){return Ye(e=>t.hasOwnProperty(e)?t[e]:ge(({path:r,args:n})=>{const s=[e,...r],i=s.pop(),u=Br[i],o=s.join(".");return t[u](o,...n)}))}function q(t,e){const r=Array.isArray(t)?t:[t],[n,s]=r,i=typeof n!="string"||n===""?[]:n.split(".");return!s&&(!e||e==="any")?i.length?[i]:[]:[i,{...typeof s<"u"&&{input:s},...e&&e!=="any"&&{type:e}}]}class z{constructor(){this.listeners=[],this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.push(e),this.onSubscribe(),()=>{this.listeners=this.listeners.filter(r=>r!==e),this.onUnsubscribe()}}hasListeners(){return this.listeners.length>0}onSubscribe(){}onUnsubscribe(){}}const te=typeof window>"u"||"Deno"in window;function A(){}function zr(t,e){return typeof t=="function"?t(e):t}function qe(t){return typeof t=="number"&&t>=0&&t!==1/0}function ut(t,e){return t.filter(r=>e.indexOf(r)===-1)}function Vr(t,e,r){const n=t.slice(0);return n[e]=r,n}function Dt(t,e){return Math.max(t+(e||0)-Date.now(),0)}function H(t,e,r){return ie(t)?typeof e=="function"?{...r,queryKey:t,queryFn:e}:{...e,queryKey:t}:t}function Hr(t,e,r){return ie(t)?typeof e=="function"?{...r,mutationKey:t,mutationFn:e}:{...e,mutationKey:t}:typeof t=="function"?{...e,mutationFn:t}:{...t}}function _(t,e,r){return ie(t)?[{...e,queryKey:t},r]:[t||{},e]}function ot(t,e){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:u,stale:o}=t;if(ie(u)){if(n){if(e.queryHash!==et(u,e.options))return!1}else if(!de(e.queryKey,u))return!1}if(r!=="all"){const a=e.isActive();if(r==="active"&&!a||r==="inactive"&&a)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||typeof s<"u"&&s!==e.state.fetchStatus||i&&!i(e))}function at(t,e){const{exact:r,fetching:n,predicate:s,mutationKey:i}=t;if(ie(i)){if(!e.options.mutationKey)return!1;if(r){if(K(e.options.mutationKey)!==K(i))return!1}else if(!de(e.options.mutationKey,i))return!1}return!(typeof n=="boolean"&&e.state.status==="loading"!==n||s&&!s(e))}function et(t,e){return(e?.queryKeyHashFn||K)(t)}function K(t){return JSON.stringify(t,(e,r)=>Ae(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function de(t,e){return Ft(t,e)}function Ft(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(r=>!Ft(t[r],e[r])):!1}function kt(t,e){if(t===e)return t;const r=ct(t)&&ct(e);if(r||Ae(t)&&Ae(e)){const n=r?t.length:Object.keys(t).length,s=r?e:Object.keys(e),i=s.length,u=r?[]:{};let o=0;for(let a=0;a<i;a++){const c=r?a:s[a];u[c]=kt(t[c],e[c]),u[c]===t[c]&&o++}return n===i&&o===n?t:u}return e}function Ie(t,e){if(t&&!e||e&&!t)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function ct(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ae(t){if(!lt(t))return!1;const e=t.constructor;if(typeof e>"u")return!0;const r=e.prototype;return!(!lt(r)||!r.hasOwnProperty("isPrototypeOf"))}function lt(t){return Object.prototype.toString.call(t)==="[object Object]"}function ie(t){return Array.isArray(t)}function _t(t){return new Promise(e=>{setTimeout(e,t)})}function ft(t){_t(0).then(t)}function Wr(){if(typeof AbortController=="function")return new AbortController}function Te(t,e,r){return r.isDataEqual!=null&&r.isDataEqual(t,e)?t:typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?kt(t,e):e}class Gr extends z{constructor(){super(),this.setup=e=>{if(!te&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),window.addEventListener("focus",r,!1),()=>{window.removeEventListener("visibilitychange",r),window.removeEventListener("focus",r)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var e;(e=this.cleanup)==null||e.call(this),this.cleanup=void 0}}setEventListener(e){var r;this.setup=e,(r=this.cleanup)==null||r.call(this),this.cleanup=e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()})}setFocused(e){this.focused=e,e&&this.onFocus()}onFocus(){this.listeners.forEach(e=>{e()})}isFocused(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)}}const ye=new Gr;class Xr extends z{constructor(){super(),this.setup=e=>{if(!te&&window.addEventListener){const r=()=>e();return window.addEventListener("online",r,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",r)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var e;(e=this.cleanup)==null||e.call(this),this.cleanup=void 0}}setEventListener(e){var r;this.setup=e,(r=this.cleanup)==null||r.call(this),this.cleanup=e(n=>{typeof n=="boolean"?this.setOnline(n):this.onOnline()})}setOnline(e){this.online=e,e&&this.onOnline()}onOnline(){this.listeners.forEach(e=>{e()})}isOnline(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine}}const pe=new Xr;function Yr(t){return Math.min(1e3*2**t,3e4)}function we(t){return(t??"online")==="online"?pe.isOnline():!0}class Ut{constructor(e){this.revert=e?.revert,this.silent=e?.silent}}function le(t){return t instanceof Ut}function jt(t){let e=!1,r=0,n=!1,s,i,u;const o=new Promise((b,m)=>{i=b,u=m}),a=b=>{n||(f(new Ut(b)),t.abort==null||t.abort())},c=()=>{e=!0},l=()=>{e=!1},d=()=>!ye.isFocused()||t.networkMode!=="always"&&!pe.isOnline(),p=b=>{n||(n=!0,t.onSuccess==null||t.onSuccess(b),s?.(),i(b))},f=b=>{n||(n=!0,t.onError==null||t.onError(b),s?.(),u(b))},h=()=>new Promise(b=>{s=m=>{const E=n||!d();return E&&b(m),E},t.onPause==null||t.onPause()}).then(()=>{s=void 0,n||t.onContinue==null||t.onContinue()}),v=()=>{if(n)return;let b;try{b=t.fn()}catch(m){b=Promise.reject(m)}Promise.resolve(b).then(p).catch(m=>{var E,S;if(n)return;const C=(E=t.retry)!=null?E:3,g=(S=t.retryDelay)!=null?S:Yr,y=typeof g=="function"?g(r,m):g,w=C===!0||typeof C=="number"&&r<C||typeof C=="function"&&C(r,m);if(e||!w){f(m);return}r++,t.onFail==null||t.onFail(r,m),_t(y).then(()=>{if(d())return h()}).then(()=>{e?f(m):v()})})};return we(t.networkMode)?v():h().then(v),{promise:o,cancel:a,continue:()=>s?.()?o:Promise.resolve(),cancelRetry:c,continueRetry:l}}const tt=console;function Zr(){let t=[],e=0,r=l=>{l()},n=l=>{l()};const s=l=>{let d;e++;try{d=l()}finally{e--,e||o()}return d},i=l=>{e?t.push(l):ft(()=>{r(l)})},u=l=>(...d)=>{i(()=>{l(...d)})},o=()=>{const l=t;t=[],l.length&&ft(()=>{n(()=>{l.forEach(d=>{r(d)})})})};return{batch:s,batchCalls:u,schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l}}}const Q=Zr();class Kt{destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),qe(this.cacheTime)&&(this.gcTimeout=setTimeout(()=>{this.optionalRemove()},this.cacheTime))}updateCacheTime(e){this.cacheTime=Math.max(this.cacheTime||0,e??(te?1/0:5*60*1e3))}clearGcTimeout(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)}}class Jr extends Kt{constructor(e){super(),this.abortSignalConsumed=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.logger=e.logger||tt,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||en(this.options),this.state=this.initialState,this.scheduleGc()}get meta(){return this.options.meta}setOptions(e){this.options={...this.defaultOptions,...e},this.updateCacheTime(this.options.cacheTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.cache.remove(this)}setData(e,r){const n=Te(this.state.data,e,this.options);return this.dispatch({data:n,type:"success",dataUpdatedAt:r?.updatedAt,manual:r?.manual}),n}setState(e,r){this.dispatch({type:"setState",state:e,setStateOptions:r})}cancel(e){var r;const n=this.promise;return(r=this.retryer)==null||r.cancel(e),n?n.then(A).catch(A):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.initialState)}isActive(){return this.observers.some(e=>e.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(e=>e.getCurrentResult().isStale)}isStaleByTime(e=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!Dt(this.state.dataUpdatedAt,e)}onFocus(){var e;const r=this.observers.find(n=>n.shouldFetchOnWindowFocus());r&&r.refetch({cancelRefetch:!1}),(e=this.retryer)==null||e.continue()}onOnline(){var e;const r=this.observers.find(n=>n.shouldFetchOnReconnect());r&&r.refetch({cancelRefetch:!1}),(e=this.retryer)==null||e.continue()}addObserver(e){this.observers.indexOf(e)===-1&&(this.observers.push(e),this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.indexOf(e)!==-1&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(this.retryer&&(this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.scheduleGc()),this.cache.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.dispatch({type:"invalidate"})}fetch(e,r){var n,s;if(this.state.fetchStatus!=="idle"){if(this.state.dataUpdatedAt&&r!=null&&r.cancelRefetch)this.cancel({silent:!0});else if(this.promise){var i;return(i=this.retryer)==null||i.continueRetry(),this.promise}}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}Array.isArray(this.options.queryKey);const u=Wr(),o={queryKey:this.queryKey,pageParam:void 0,meta:this.meta},a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>{if(u)return this.abortSignalConsumed=!0,u.signal}})};a(o);const c=()=>this.options.queryFn?(this.abortSignalConsumed=!1,this.options.queryFn(o)):Promise.reject("Missing queryFn"),l={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:c};if(a(l),(n=this.options.behavior)==null||n.onFetch(l),this.revertState=this.state,this.state.fetchStatus==="idle"||this.state.fetchMeta!==((s=l.fetchOptions)==null?void 0:s.meta)){var d;this.dispatch({type:"fetch",meta:(d=l.fetchOptions)==null?void 0:d.meta})}const p=f=>{if(le(f)&&f.silent||this.dispatch({type:"error",error:f}),!le(f)){var h,v,b,m;(h=(v=this.cache.config).onError)==null||h.call(v,f,this),(b=(m=this.cache.config).onSettled)==null||b.call(m,this.state.data,f,this)}this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return this.retryer=jt({fn:l.fetchFn,abort:u?.abort.bind(u),onSuccess:f=>{var h,v,b,m;if(typeof f>"u"){p(new Error(this.queryHash+" data is undefined"));return}this.setData(f),(h=(v=this.cache.config).onSuccess)==null||h.call(v,f,this),(b=(m=this.cache.config).onSettled)==null||b.call(m,f,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:p,onFail:(f,h)=>{this.dispatch({type:"failed",failureCount:f,error:h})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode}),this.promise=this.retryer.promise,this.promise}dispatch(e){const r=n=>{var s,i;switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:(s=e.meta)!=null?s:null,fetchStatus:we(this.options.networkMode)?"fetching":"paused",...!n.dataUpdatedAt&&{error:null,status:"loading"}};case"success":return{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(i=e.dataUpdatedAt)!=null?i:Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const u=e.error;return le(u)&&u.revert&&this.revertState?{...this.revertState}:{...n,error:u,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:u,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=r(this.state),Q.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate(e)}),this.cache.notify({query:this,type:"updated",action:e})})}}function en(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=typeof e<"u",n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"loading",fetchStatus:"idle"}}class tn extends z{constructor(e){super(),this.config=e||{},this.queries=[],this.queriesMap={}}build(e,r,n){var s;const i=r.queryKey,u=(s=r.queryHash)!=null?s:et(i,r);let o=this.get(u);return o||(o=new Jr({cache:this,logger:e.getLogger(),queryKey:i,queryHash:u,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(o)),o}add(e){this.queriesMap[e.queryHash]||(this.queriesMap[e.queryHash]=e,this.queries.push(e),this.notify({type:"added",query:e}))}remove(e){const r=this.queriesMap[e.queryHash];r&&(e.destroy(),this.queries=this.queries.filter(n=>n!==e),r===e&&delete this.queriesMap[e.queryHash],this.notify({type:"removed",query:e}))}clear(){Q.batch(()=>{this.queries.forEach(e=>{this.remove(e)})})}get(e){return this.queriesMap[e]}getAll(){return this.queries}find(e,r){const[n]=_(e,r);return typeof n.exact>"u"&&(n.exact=!0),this.queries.find(s=>ot(n,s))}findAll(e,r){const[n]=_(e,r);return Object.keys(n).length>0?this.queries.filter(s=>ot(n,s)):this.queries}notify(e){Q.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){Q.batch(()=>{this.queries.forEach(e=>{e.onFocus()})})}onOnline(){Q.batch(()=>{this.queries.forEach(e=>{e.onOnline()})})}}class rn extends Kt{constructor(e){super(),this.defaultOptions=e.defaultOptions,this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.logger=e.logger||tt,this.observers=[],this.state=e.state||Nt(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options={...this.defaultOptions,...e},this.updateCacheTime(this.options.cacheTime)}get meta(){return this.options.meta}setState(e){this.dispatch({type:"setState",state:e})}addObserver(e){this.observers.indexOf(e)===-1&&(this.observers.push(e),this.clearGcTimeout(),this.mutationCache.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.observers=this.observers.filter(r=>r!==e),this.scheduleGc(),this.mutationCache.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.observers.length||(this.state.status==="loading"?this.scheduleGc():this.mutationCache.remove(this))}continue(){var e,r;return(e=(r=this.retryer)==null?void 0:r.continue())!=null?e:this.execute()}async execute(){const e=()=>{var w;return this.retryer=jt({fn:()=>this.options.mutationFn?this.options.mutationFn(this.state.variables):Promise.reject("No mutationFn found"),onFail:(O,x)=>{this.dispatch({type:"failed",failureCount:O,error:x})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:(w=this.options.retry)!=null?w:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode}),this.retryer.promise},r=this.state.status==="loading";try{var n,s,i,u,o,a,c,l;if(!r){var d,p,f,h;this.dispatch({type:"loading",variables:this.options.variables}),await((d=(p=this.mutationCache.config).onMutate)==null?void 0:d.call(p,this.state.variables,this));const O=await((f=(h=this.options).onMutate)==null?void 0:f.call(h,this.state.variables));O!==this.state.context&&this.dispatch({type:"loading",context:O,variables:this.state.variables})}const w=await e();return await((n=(s=this.mutationCache.config).onSuccess)==null?void 0:n.call(s,w,this.state.variables,this.state.context,this)),await((i=(u=this.options).onSuccess)==null?void 0:i.call(u,w,this.state.variables,this.state.context)),await((o=(a=this.mutationCache.config).onSettled)==null?void 0:o.call(a,w,null,this.state.variables,this.state.context,this)),await((c=(l=this.options).onSettled)==null?void 0:c.call(l,w,null,this.state.variables,this.state.context)),this.dispatch({type:"success",data:w}),w}catch(w){try{var v,b,m,E,S,C,g,y;throw await((v=(b=this.mutationCache.config).onError)==null?void 0:v.call(b,w,this.state.variables,this.state.context,this)),await((m=(E=this.options).onError)==null?void 0:m.call(E,w,this.state.variables,this.state.context)),await((S=(C=this.mutationCache.config).onSettled)==null?void 0:S.call(C,void 0,w,this.state.variables,this.state.context,this)),await((g=(y=this.options).onSettled)==null?void 0:g.call(y,void 0,w,this.state.variables,this.state.context)),w}finally{this.dispatch({type:"error",error:w})}}}dispatch(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"loading":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!we(this.options.networkMode),status:"loading",variables:e.variables};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"};case"setState":return{...n,...e.state}}};this.state=r(this.state),Q.batch(()=>{this.observers.forEach(n=>{n.onMutationUpdate(e)}),this.mutationCache.notify({mutation:this,type:"updated",action:e})})}}function Nt(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0}}class nn extends z{constructor(e){super(),this.config=e||{},this.mutations=[],this.mutationId=0}build(e,r,n){const s=new rn({mutationCache:this,logger:e.getLogger(),mutationId:++this.mutationId,options:e.defaultMutationOptions(r),state:n,defaultOptions:r.mutationKey?e.getMutationDefaults(r.mutationKey):void 0});return this.add(s),s}add(e){this.mutations.push(e),this.notify({type:"added",mutation:e})}remove(e){this.mutations=this.mutations.filter(r=>r!==e),this.notify({type:"removed",mutation:e})}clear(){Q.batch(()=>{this.mutations.forEach(e=>{this.remove(e)})})}getAll(){return this.mutations}find(e){return typeof e.exact>"u"&&(e.exact=!0),this.mutations.find(r=>at(e,r))}findAll(e){return this.mutations.filter(r=>at(e,r))}notify(e){Q.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){var e;return this.resuming=((e=this.resuming)!=null?e:Promise.resolve()).then(()=>{const r=this.mutations.filter(n=>n.state.isPaused);return Q.batch(()=>r.reduce((n,s)=>n.then(()=>s.continue().catch(A)),Promise.resolve()))}).then(()=>{this.resuming=void 0}),this.resuming}}function Me(){return{onFetch:t=>{t.fetchFn=()=>{var e,r,n,s,i,u;const o=(e=t.fetchOptions)==null||(r=e.meta)==null?void 0:r.refetchPage,a=(n=t.fetchOptions)==null||(s=n.meta)==null?void 0:s.fetchMore,c=a?.pageParam,l=a?.direction==="forward",d=a?.direction==="backward",p=((i=t.state.data)==null?void 0:i.pages)||[],f=((u=t.state.data)==null?void 0:u.pageParams)||[];let h=f,v=!1;const b=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>{var w;if((w=t.signal)!=null&&w.aborted)v=!0;else{var O;(O=t.signal)==null||O.addEventListener("abort",()=>{v=!0})}return t.signal}})},m=t.options.queryFn||(()=>Promise.reject("Missing queryFn")),E=(y,w,O,x)=>(h=x?[w,...h]:[...h,w],x?[O,...y]:[...y,O]),S=(y,w,O,x)=>{if(v)return Promise.reject("Cancelled");if(typeof O>"u"&&!w&&y.length)return Promise.resolve(y);const R={queryKey:t.queryKey,pageParam:O,meta:t.options.meta};b(R);const I=m(R);return Promise.resolve(I).then(Se=>E(y,O,Se,x))};let C;if(!p.length)C=S([]);else if(l){const y=typeof c<"u",w=y?c:De(t.options,p);C=S(p,y,w)}else if(d){const y=typeof c<"u",w=y?c:Lt(t.options,p);C=S(p,y,w,!0)}else{h=[];const y=typeof t.options.getNextPageParam>"u";C=(o&&p[0]?o(p[0],0,p):!0)?S([],y,f[0]):Promise.resolve(E([],f[0],p[0]));for(let O=1;O<p.length;O++)C=C.then(x=>{if(o&&p[O]?o(p[O],O,p):!0){const I=y?f[O]:De(t.options,x);return S(x,y,I)}return Promise.resolve(E(x,f[O],p[O]))})}return C.then(y=>({pages:y,pageParams:h}))}}}}function De(t,e){return t.getNextPageParam==null?void 0:t.getNextPageParam(e[e.length-1],e)}function Lt(t,e){return t.getPreviousPageParam==null?void 0:t.getPreviousPageParam(e[0],e)}function sn(t,e){if(t.getNextPageParam&&Array.isArray(e)){const r=De(t,e);return typeof r<"u"&&r!==null&&r!==!1}}function un(t,e){if(t.getPreviousPageParam&&Array.isArray(e)){const r=Lt(t,e);return typeof r<"u"&&r!==null&&r!==!1}}class on{constructor(e={}){this.queryCache=e.queryCache||new tn,this.mutationCache=e.mutationCache||new nn,this.logger=e.logger||tt,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[],this.mountCount=0}mount(){this.mountCount++,this.mountCount===1&&(this.unsubscribeFocus=ye.subscribe(()=>{ye.isFocused()&&(this.resumePausedMutations(),this.queryCache.onFocus())}),this.unsubscribeOnline=pe.subscribe(()=>{pe.isOnline()&&(this.resumePausedMutations(),this.queryCache.onOnline())}))}unmount(){var e,r;this.mountCount--,this.mountCount===0&&((e=this.unsubscribeFocus)==null||e.call(this),this.unsubscribeFocus=void 0,(r=this.unsubscribeOnline)==null||r.call(this),this.unsubscribeOnline=void 0)}isFetching(e,r){const[n]=_(e,r);return n.fetchStatus="fetching",this.queryCache.findAll(n).length}isMutating(e){return this.mutationCache.findAll({...e,fetching:!0}).length}getQueryData(e,r){var n;return(n=this.queryCache.find(e,r))==null?void 0:n.state.data}ensureQueryData(e,r,n){const s=H(e,r,n),i=this.getQueryData(s.queryKey);return i?Promise.resolve(i):this.fetchQuery(s)}getQueriesData(e){return this.getQueryCache().findAll(e).map(({queryKey:r,state:n})=>{const s=n.data;return[r,s]})}setQueryData(e,r,n){const s=this.queryCache.find(e),i=s?.state.data,u=zr(r,i);if(typeof u>"u")return;const o=H(e),a=this.defaultQueryOptions(o);return this.queryCache.build(this,a).setData(u,{...n,manual:!0})}setQueriesData(e,r,n){return Q.batch(()=>this.getQueryCache().findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,r,n)]))}getQueryState(e,r){var n;return(n=this.queryCache.find(e,r))==null?void 0:n.state}removeQueries(e,r){const[n]=_(e,r),s=this.queryCache;Q.batch(()=>{s.findAll(n).forEach(i=>{s.remove(i)})})}resetQueries(e,r,n){const[s,i]=_(e,r,n),u=this.queryCache,o={type:"active",...s};return Q.batch(()=>(u.findAll(s).forEach(a=>{a.reset()}),this.refetchQueries(o,i)))}cancelQueries(e,r,n){const[s,i={}]=_(e,r,n);typeof i.revert>"u"&&(i.revert=!0);const u=Q.batch(()=>this.queryCache.findAll(s).map(o=>o.cancel(i)));return Promise.all(u).then(A).catch(A)}invalidateQueries(e,r,n){const[s,i]=_(e,r,n);return Q.batch(()=>{var u,o;if(this.queryCache.findAll(s).forEach(c=>{c.invalidate()}),s.refetchType==="none")return Promise.resolve();const a={...s,type:(u=(o=s.refetchType)!=null?o:s.type)!=null?u:"active"};return this.refetchQueries(a,i)})}refetchQueries(e,r,n){const[s,i]=_(e,r,n),u=Q.batch(()=>this.queryCache.findAll(s).filter(a=>!a.isDisabled()).map(a=>{var c;return a.fetch(void 0,{...i,cancelRefetch:(c=i?.cancelRefetch)!=null?c:!0,meta:{refetchPage:s.refetchPage}})}));let o=Promise.all(u).then(A);return i!=null&&i.throwOnError||(o=o.catch(A)),o}fetchQuery(e,r,n){const s=H(e,r,n),i=this.defaultQueryOptions(s);typeof i.retry>"u"&&(i.retry=!1);const u=this.queryCache.build(this,i);return u.isStaleByTime(i.staleTime)?u.fetch(i):Promise.resolve(u.state.data)}prefetchQuery(e,r,n){return this.fetchQuery(e,r,n).then(A).catch(A)}fetchInfiniteQuery(e,r,n){const s=H(e,r,n);return s.behavior=Me(),this.fetchQuery(s)}prefetchInfiniteQuery(e,r,n){return this.fetchInfiniteQuery(e,r,n).then(A).catch(A)}resumePausedMutations(){return this.mutationCache.resumePausedMutations()}getQueryCache(){return this.queryCache}getMutationCache(){return this.mutationCache}getLogger(){return this.logger}getDefaultOptions(){return this.defaultOptions}setDefaultOptions(e){this.defaultOptions=e}setQueryDefaults(e,r){const n=this.queryDefaults.find(s=>K(e)===K(s.queryKey));n?n.defaultOptions=r:this.queryDefaults.push({queryKey:e,defaultOptions:r})}getQueryDefaults(e){if(!e)return;const r=this.queryDefaults.find(n=>de(e,n.queryKey));return r?.defaultOptions}setMutationDefaults(e,r){const n=this.mutationDefaults.find(s=>K(e)===K(s.mutationKey));n?n.defaultOptions=r:this.mutationDefaults.push({mutationKey:e,defaultOptions:r})}getMutationDefaults(e){if(!e)return;const r=this.mutationDefaults.find(n=>de(e,n.mutationKey));return r?.defaultOptions}defaultQueryOptions(e){if(e!=null&&e._defaulted)return e;const r={...this.defaultOptions.queries,...this.getQueryDefaults(e?.queryKey),...e,_defaulted:!0};return!r.queryHash&&r.queryKey&&(r.queryHash=et(r.queryKey,r)),typeof r.refetchOnReconnect>"u"&&(r.refetchOnReconnect=r.networkMode!=="always"),typeof r.useErrorBoundary>"u"&&(r.useErrorBoundary=!!r.suspense),r}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...this.defaultOptions.mutations,...this.getMutationDefaults(e?.mutationKey),...e,_defaulted:!0}}clear(){this.queryCache.clear(),this.mutationCache.clear()}}class rt extends z{constructor(e,r){super(),this.client=e,this.options=r,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(r)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.length===1&&(this.currentQuery.addObserver(this),ht(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.listeners.length||this.destroy()}shouldFetchOnReconnect(){return Fe(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Fe(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=[],this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(e,r){const n=this.options,s=this.currentQuery;if(this.options=this.client.defaultQueryOptions(e),Ie(n,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=n.queryKey),this.updateQuery();const i=this.hasListeners();i&&dt(this.currentQuery,s,this.options,n)&&this.executeFetch(),this.updateResult(r),i&&(this.currentQuery!==s||this.options.enabled!==n.enabled||this.options.staleTime!==n.staleTime)&&this.updateStaleTimeout();const u=this.computeRefetchInterval();i&&(this.currentQuery!==s||this.options.enabled!==n.enabled||u!==this.currentRefetchInterval)&&this.updateRefetchInterval(u)}getOptimisticResult(e){const r=this.client.getQueryCache().build(this.client,e);return this.createResult(r,e)}getCurrentResult(){return this.currentResult}trackResult(e){const r={};return Object.keys(e).forEach(n=>{Object.defineProperty(r,n,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(n),e[n])})}),r}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:e,...r}={}){return this.fetch({...r,meta:{refetchPage:e}})}fetchOptimistic(e){const r=this.client.defaultQueryOptions(e),n=this.client.getQueryCache().build(this.client,r);return n.isFetchingOptimistic=!0,n.fetch().then(()=>this.createResult(n,r))}fetch(e){var r;return this.executeFetch({...e,cancelRefetch:(r=e.cancelRefetch)!=null?r:!0}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(e){this.updateQuery();let r=this.currentQuery.fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(A)),r}updateStaleTimeout(){if(this.clearStaleTimeout(),te||this.currentResult.isStale||!qe(this.options.staleTime))return;const r=Dt(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},r)}computeRefetchInterval(){var e;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(e=this.options.refetchInterval)!=null?e:!1}updateRefetchInterval(e){this.clearRefetchInterval(),this.currentRefetchInterval=e,!(te||this.options.enabled===!1||!qe(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||ye.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(e,r){const n=this.currentQuery,s=this.options,i=this.currentResult,u=this.currentResultState,o=this.currentResultOptions,a=e!==n,c=a?e.state:this.currentQueryInitialState,l=a?this.currentResult:this.previousQueryResult,{state:d}=e;let{dataUpdatedAt:p,error:f,errorUpdatedAt:h,fetchStatus:v,status:b}=d,m=!1,E=!1,S;if(r._optimisticResults){const O=this.hasListeners(),x=!O&&ht(e,r),R=O&&dt(e,n,r,s);(x||R)&&(v=we(e.options.networkMode)?"fetching":"paused",p||(b="loading")),r._optimisticResults==="isRestoring"&&(v="idle")}if(r.keepPreviousData&&!d.dataUpdatedAt&&l!=null&&l.isSuccess&&b!=="error")S=l.data,p=l.dataUpdatedAt,b=l.status,m=!0;else if(r.select&&typeof d.data<"u")if(i&&d.data===u?.data&&r.select===this.selectFn)S=this.selectResult;else try{this.selectFn=r.select,S=r.select(d.data),S=Te(i?.data,S,r),this.selectResult=S,this.selectError=null}catch(O){this.selectError=O}else S=d.data;if(typeof r.placeholderData<"u"&&typeof S>"u"&&b==="loading"){let O;if(i!=null&&i.isPlaceholderData&&r.placeholderData===o?.placeholderData)O=i.data;else if(O=typeof r.placeholderData=="function"?r.placeholderData():r.placeholderData,r.select&&typeof O<"u")try{O=r.select(O),this.selectError=null}catch(x){this.selectError=x}typeof O<"u"&&(b="success",S=Te(i?.data,O,r),E=!0)}this.selectError&&(f=this.selectError,S=this.selectResult,h=Date.now(),b="error");const C=v==="fetching",g=b==="loading",y=b==="error";return{status:b,fetchStatus:v,isLoading:g,isSuccess:b==="success",isError:y,isInitialLoading:g&&C,data:S,dataUpdatedAt:p,error:f,errorUpdatedAt:h,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:C,isRefetching:C&&!g,isLoadingError:y&&d.dataUpdatedAt===0,isPaused:v==="paused",isPlaceholderData:E,isPreviousData:m,isRefetchError:y&&d.dataUpdatedAt!==0,isStale:nt(e,r),refetch:this.refetch,remove:this.remove}}updateResult(e){const r=this.currentResult,n=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,Ie(n,r))return;this.currentResult=n;const s={cache:!0},i=()=>{if(!r)return!0;const{notifyOnChangeProps:u}=this.options;if(u==="all"||!u&&!this.trackedProps.size)return!0;const o=new Set(u??this.trackedProps);return this.options.useErrorBoundary&&o.add("error"),Object.keys(this.currentResult).some(a=>{const c=a;return this.currentResult[c]!==r[c]&&o.has(c)})};e?.listeners!==!1&&i()&&(s.listeners=!0),this.notify({...s,...e})}updateQuery(){const e=this.client.getQueryCache().build(this.client,this.options);if(e===this.currentQuery)return;const r=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(r?.removeObserver(this),e.addObserver(this))}onQueryUpdate(e){const r={};e.type==="success"?r.onSuccess=!e.manual:e.type==="error"&&!le(e.error)&&(r.onError=!0),this.updateResult(r),this.hasListeners()&&this.updateTimers()}notify(e){Q.batch(()=>{if(e.onSuccess){var r,n,s,i;(r=(n=this.options).onSuccess)==null||r.call(n,this.currentResult.data),(s=(i=this.options).onSettled)==null||s.call(i,this.currentResult.data,null)}else if(e.onError){var u,o,a,c;(u=(o=this.options).onError)==null||u.call(o,this.currentResult.error),(a=(c=this.options).onSettled)==null||a.call(c,void 0,this.currentResult.error)}e.listeners&&this.listeners.forEach(l=>{l(this.currentResult)}),e.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function an(t,e){return e.enabled!==!1&&!t.state.dataUpdatedAt&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ht(t,e){return an(t,e)||t.state.dataUpdatedAt>0&&Fe(t,e,e.refetchOnMount)}function Fe(t,e,r){if(e.enabled!==!1){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&nt(t,e)}return!1}function dt(t,e,r,n){return r.enabled!==!1&&(t!==e||n.enabled===!1)&&(!r.suspense||t.state.status!=="error")&&nt(t,r)}function nt(t,e){return t.isStaleByTime(e.staleTime)}class cn extends z{constructor(e,r){super(),this.client=e,this.queries=[],this.result=[],this.observers=[],this.observersMap={},r&&this.setQueries(r)}onSubscribe(){this.listeners.length===1&&this.observers.forEach(e=>{e.subscribe(r=>{this.onUpdate(e,r)})})}onUnsubscribe(){this.listeners.length||this.destroy()}destroy(){this.listeners=[],this.observers.forEach(e=>{e.destroy()})}setQueries(e,r){this.queries=e,Q.batch(()=>{const n=this.observers,s=this.findMatchingObservers(this.queries);s.forEach(c=>c.observer.setOptions(c.defaultedQueryOptions,r));const i=s.map(c=>c.observer),u=Object.fromEntries(i.map(c=>[c.options.queryHash,c])),o=i.map(c=>c.getCurrentResult()),a=i.some((c,l)=>c!==n[l]);n.length===i.length&&!a||(this.observers=i,this.observersMap=u,this.result=o,this.hasListeners()&&(ut(n,i).forEach(c=>{c.destroy()}),ut(i,n).forEach(c=>{c.subscribe(l=>{this.onUpdate(c,l)})}),this.notify()))})}getCurrentResult(){return this.result}getQueries(){return this.observers.map(e=>e.getCurrentQuery())}getObservers(){return this.observers}getOptimisticResult(e){return this.findMatchingObservers(e).map(r=>r.observer.getOptimisticResult(r.defaultedQueryOptions))}findMatchingObservers(e){const r=this.observers,n=new Map(r.map(f=>[f.options.queryHash,f])),s=e.map(f=>this.client.defaultQueryOptions(f)),i=s.flatMap(f=>{const h=n.get(f.queryHash);return h!=null?[{defaultedQueryOptions:f,observer:h}]:[]}),u=new Set(i.map(f=>f.defaultedQueryOptions.queryHash)),o=s.filter(f=>!u.has(f.queryHash)),a=new Set(i.map(f=>f.observer)),c=r.filter(f=>!a.has(f)),l=f=>{const h=this.client.defaultQueryOptions(f),v=this.observersMap[h.queryHash];return v??new rt(this.client,h)},d=o.map((f,h)=>{if(f.keepPreviousData){const v=c[h];if(v!==void 0)return{defaultedQueryOptions:f,observer:v}}return{defaultedQueryOptions:f,observer:l(f)}}),p=(f,h)=>s.indexOf(f.defaultedQueryOptions)-s.indexOf(h.defaultedQueryOptions);return i.concat(d).sort(p)}onUpdate(e,r){const n=this.observers.indexOf(e);n!==-1&&(this.result=Vr(this.result,n,r),this.notify())}notify(){Q.batch(()=>{this.listeners.forEach(e=>{e(this.result)})})}}class ln extends rt{constructor(e,r){super(e,r)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e,r){super.setOptions({...e,behavior:Me()},r)}getOptimisticResult(e){return e.behavior=Me(),super.getOptimisticResult(e)}fetchNextPage({pageParam:e,...r}={}){return this.fetch({...r,meta:{fetchMore:{direction:"forward",pageParam:e}}})}fetchPreviousPage({pageParam:e,...r}={}){return this.fetch({...r,meta:{fetchMore:{direction:"backward",pageParam:e}}})}createResult(e,r){var n,s,i,u,o,a;const{state:c}=e,l=super.createResult(e,r),{isFetching:d,isRefetching:p}=l,f=d&&((n=c.fetchMeta)==null||(s=n.fetchMore)==null?void 0:s.direction)==="forward",h=d&&((i=c.fetchMeta)==null||(u=i.fetchMore)==null?void 0:u.direction)==="backward";return{...l,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:sn(r,(o=c.data)==null?void 0:o.pages),hasPreviousPage:un(r,(a=c.data)==null?void 0:a.pages),isFetchingNextPage:f,isFetchingPreviousPage:h,isRefetching:p&&!f&&!h}}}class fn extends z{constructor(e,r){super(),this.client=e,this.setOptions(r),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var r;const n=this.options;this.options=this.client.defaultMutationOptions(e),Ie(n,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(r=this.currentMutation)==null||r.setOptions(this.options)}onUnsubscribe(){if(!this.listeners.length){var e;(e=this.currentMutation)==null||e.removeObserver(this)}}onMutationUpdate(e){this.updateResult();const r={listeners:!0};e.type==="success"?r.onSuccess=!0:e.type==="error"&&(r.onError=!0),this.notify(r)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(e,r){return this.mutateOptions=r,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof e<"u"?e:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const e=this.currentMutation?this.currentMutation.state:Nt(),r={...e,isLoading:e.status==="loading",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=r}notify(e){Q.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(e.onSuccess){var r,n,s,i;(r=(n=this.mutateOptions).onSuccess)==null||r.call(n,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(s=(i=this.mutateOptions).onSettled)==null||s.call(i,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(e.onError){var u,o,a,c;(u=(o=this.mutateOptions).onError)==null||u.call(o,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(a=(c=this.mutateOptions).onSettled)==null||a.call(c,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}e.listeners&&this.listeners.forEach(l=>{l(this.currentResult)})})}}var Bt={exports:{}},$t={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G=P;function hn(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dn=typeof Object.is=="function"?Object.is:hn,yn=G.useState,pn=G.useEffect,vn=G.useLayoutEffect,mn=G.useDebugValue;function bn(t,e){var r=e(),n=yn({inst:{value:r,getSnapshot:e}}),s=n[0].inst,i=n[1];return vn(function(){s.value=r,s.getSnapshot=e,Ce(s)&&i({inst:s})},[t,r,e]),pn(function(){return Ce(s)&&i({inst:s}),t(function(){Ce(s)&&i({inst:s})})},[t]),mn(r),r}function Ce(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!dn(t,r)}catch{return!0}}function gn(t,e){return e()}var wn=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?gn:bn;$t.useSyncExternalStore=G.useSyncExternalStore!==void 0?G.useSyncExternalStore:wn;Bt.exports=$t;var On=Bt.exports;const st=On.useSyncExternalStore,yt=P.createContext(void 0),zt=P.createContext(!1);function Vt(t,e){return t||(e&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=yt),window.ReactQueryClientContext):yt)}const Oe=({context:t}={})=>{const e=P.useContext(Vt(t,P.useContext(zt)));if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},Pn=({client:t,children:e,context:r,contextSharing:n=!1})=>{P.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]);const s=Vt(r,n);return P.createElement(zt.Provider,{value:!r&&n},P.createElement(s.Provider,{value:t},e))},Ht=P.createContext(!1),Wt=()=>P.useContext(Ht);Ht.Provider;function Sn(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}const Cn=P.createContext(Sn()),Gt=()=>P.useContext(Cn);function Xt(t,e){return typeof t=="function"?t(...e):!!t}const Yt=(t,e)=>{(t.suspense||t.useErrorBoundary)&&(e.isReset()||(t.retryOnMount=!1))},Zt=t=>{P.useEffect(()=>{t.clearReset()},[t])},Jt=({result:t,errorResetBoundary:e,useErrorBoundary:r,query:n})=>t.isError&&!e.isReset()&&!t.isFetching&&Xt(r,[t.error,n]),er=t=>{t.suspense&&typeof t.staleTime!="number"&&(t.staleTime=1e3)},tr=(t,e)=>t.isLoading&&t.isFetching&&!e,ke=(t,e,r)=>t?.suspense&&tr(e,r),_e=(t,e,r)=>e.fetchOptimistic(t).then(({data:n})=>{t.onSuccess==null||t.onSuccess(n),t.onSettled==null||t.onSettled(n,null)}).catch(n=>{r.clearReset(),t.onError==null||t.onError(n),t.onSettled==null||t.onSettled(void 0,n)});function Rn({queries:t,context:e}){const r=Oe({context:e}),n=Wt(),s=Gt(),i=P.useMemo(()=>t.map(p=>{const f=r.defaultQueryOptions(p);return f._optimisticResults=n?"isRestoring":"optimistic",f}),[t,r,n]);i.forEach(p=>{er(p),Yt(p,s)}),Zt(s);const[u]=P.useState(()=>new cn(r,i)),o=u.getOptimisticResult(i);st(P.useCallback(p=>n?()=>{}:u.subscribe(Q.batchCalls(p)),[u,n]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),P.useEffect(()=>{u.setQueries(i,{listeners:!1})},[i,u]);const c=o.some((p,f)=>ke(i[f],p,n))?o.flatMap((p,f)=>{const h=i[f],v=u.getObservers()[f];if(h&&v){if(ke(h,p,n))return _e(h,v,s);tr(p,n)&&_e(h,v,s)}return[]}):[];if(c.length>0)throw Promise.all(c);const l=u.getQueries(),d=o.find((p,f)=>{var h,v;return Jt({result:p,errorResetBoundary:s,useErrorBoundary:(h=(v=i[f])==null?void 0:v.useErrorBoundary)!=null?h:!1,query:l[f]})});if(d!=null&&d.error)throw d.error;return o}function rr(t,e){const r=Oe({context:t.context}),n=Wt(),s=Gt(),i=r.defaultQueryOptions(t);i._optimisticResults=n?"isRestoring":"optimistic",i.onError&&(i.onError=Q.batchCalls(i.onError)),i.onSuccess&&(i.onSuccess=Q.batchCalls(i.onSuccess)),i.onSettled&&(i.onSettled=Q.batchCalls(i.onSettled)),er(i),Yt(i,s),Zt(s);const[u]=P.useState(()=>new e(r,i)),o=u.getOptimisticResult(i);if(st(P.useCallback(a=>n?()=>{}:u.subscribe(Q.batchCalls(a)),[u,n]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),P.useEffect(()=>{u.setOptions(i,{listeners:!1})},[i,u]),ke(i,o,n))throw _e(i,u,s);if(Jt({result:o,errorResetBoundary:s,useErrorBoundary:i.useErrorBoundary,query:u.getCurrentQuery()}))throw o.error;return i.notifyOnChangeProps?o:u.trackResult(o)}function En(t,e,r){const n=H(t,e,r);return rr(n,rt)}function xn(t,e,r){const n=Hr(t,e,r),s=Oe({context:n.context}),[i]=P.useState(()=>new fn(s,n));P.useEffect(()=>{i.setOptions(n)},[i,n]);const u=st(P.useCallback(a=>i.subscribe(Q.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),o=P.useCallback((a,c)=>{i.mutate(a,c).catch(Qn)},[i]);if(u.error&&Xt(i.options.useErrorBoundary,[u.error]))throw u.error;return{...u,mutate:o,mutateAsync:u.mutate}}function Qn(){}function qn(t,e,r){const n=H(t,e,r);return rr(n,ln)}function ve(t,e){return t.length?e===void 0?[t]:[t,e]:[]}function In(t,e){return ge(r=>{const n=r.args,s=[t,...r.path],i=s.pop(),u=s.join(".");if(i==="useMutation")return e[i](u,...n);const[o,...a]=n,c=ve(u,o);if(i==="getQueryKey")return q(c,a[0]??"any");if(i==="_def")return{path:s};if(i.startsWith("useSuspense")){const l=a[0]||{},p=e[i==="useSuspenseQuery"?"useQuery":"useInfiniteQuery"](c,{...l,suspense:!0,enabled:!0});return[p.data,p]}return e[i](c,...a)})}const An=["client","ssrContext","ssrState","abortOnUnmount"],Tn=P.createContext(null);function Mn(t){return Ye(e=>{const r=e;return r==="client"?$r(t.client):An.includes(r)?t[r]:ge(({path:n,args:s})=>{const i=[e,...n],u=i.pop(),o=i.join("."),a=f=>{if(["setData","setInfiniteData"].includes(f)){const[m,E,...S]=s;return{queryKey:ve(o,m),updater:E,rest:S}}const[h,...v]=s;return{queryKey:ve(o,h),rest:v}},{queryKey:c,rest:l,updater:d}=a(u);return{fetch:()=>t.fetchQuery(c,...l),fetchInfinite:()=>t.fetchInfiniteQuery(c,...l),prefetch:()=>t.prefetchQuery(c,...l),prefetchInfinite:()=>t.prefetchInfiniteQuery(c,...l),ensureData:()=>t.ensureQueryData(c,...l),invalidate:()=>t.invalidateQueries(c,...l),reset:()=>t.resetQueries(c,...l),refetch:()=>t.refetchQueries(c,...l),cancel:()=>t.cancelQuery(c,...l),setData:()=>t.setQueryData(c,d,...l),setInfiniteData:()=>t.setInfiniteQueryData(c,d,...l),getData:()=>t.getQueryData(c),getInfiniteData:()=>t.getInfiniteQueryData(c)}[u]()})})}function Dn(t){return ge(e=>{const r=e.path.join("."),[n,...s]=e.args;return{queryKey:ve(r,n),queryFn:()=>t.query(r,n),...s[0]}})}function k(t,e){const[r,n]=t;return[r,n,e?.trpc]}function Re(t){const e=P.useRef(t);return e.current.path=t.path,e.current}function Fn(t){const e=(t?.overrides??t?.unstable_overrides)?.useMutation?.onSuccess??(h=>h.originalFn()),r=t?.context??Tn,n=t?.reactQueryContext,s=h=>Lr(h),i=h=>{const{abortOnUnmount:v=!1,client:b,queryClient:m,ssrContext:E}=h,[S,C]=P.useState(h.ssrState??!1);return P.useEffect(()=>{C(g=>g?"mounted":!1)},[]),it.createElement(r.Provider,{value:{abortOnUnmount:v,queryClient:m,client:b,ssrContext:E||null,ssrState:S,fetchQuery:P.useCallback((g,y)=>m.fetchQuery({...y,queryKey:q(g,"query"),queryFn:()=>b.query(...k(g,y))}),[b,m]),fetchInfiniteQuery:P.useCallback((g,y)=>m.fetchInfiniteQuery({...y,queryKey:q(g,"infinite"),queryFn:({pageParam:w})=>{const[O,x]=g,R={...x,cursor:w};return b.query(...k([O,R],y))}}),[b,m]),prefetchQuery:P.useCallback((g,y)=>m.prefetchQuery({...y,queryKey:q(g,"query"),queryFn:()=>b.query(...k(g,y))}),[b,m]),prefetchInfiniteQuery:P.useCallback((g,y)=>m.prefetchInfiniteQuery({...y,queryKey:q(g,"infinite"),queryFn:({pageParam:w})=>{const[O,x]=g,R={...x,cursor:w};return b.query(...k([O,R],y))}}),[b,m]),ensureQueryData:P.useCallback((g,y)=>m.ensureQueryData({...y,queryKey:q(g,"query"),queryFn:()=>b.query(...k(g,y))}),[b,m]),invalidateQueries:P.useCallback((g,y,w)=>m.invalidateQueries({...y,queryKey:q(g,"any")},w),[m]),resetQueries:P.useCallback((...g)=>{const[y,w,O]=g;return m.resetQueries({...w,queryKey:q(y,"any")},O)},[m]),refetchQueries:P.useCallback((...g)=>{const[y,w,O]=g;return m.refetchQueries({...w,queryKey:q(y,"any")},O)},[m]),cancelQuery:P.useCallback(g=>m.cancelQueries({queryKey:q(g,"any")}),[m]),setQueryData:P.useCallback((...g)=>{const[y,...w]=g;return m.setQueryData(q(y,"query"),...w)},[m]),getQueryData:P.useCallback((...g)=>{const[y,...w]=g;return m.getQueryData(q(y,"query"),...w)},[m]),setInfiniteQueryData:P.useCallback((...g)=>{const[y,...w]=g;return m.setQueryData(q(y,"infinite"),...w)},[m]),getInfiniteQueryData:P.useCallback((...g)=>{const[y,...w]=g;return m.getQueryData(q(y,"infinite"),...w)},[m])}},h.children)};function u(){return it.useContext(r)}function o(h,v,b){const{queryClient:m,ssrState:E}=u();return E&&E!=="mounted"&&m.getQueryCache().find(q(h,v))?.state.status==="error"?{retryOnMount:!1,...b}:b}function a(h,v){const b=u();if(!b)throw new Error("Unable to retrieve application context. Did you forget to wrap your App inside `withTRPC` HoC?");const{abortOnUnmount:m,client:E,ssrState:S,queryClient:C,prefetchQuery:g}=b;typeof window>"u"&&S==="prepass"&&v?.trpc?.ssr!==!1&&v?.enabled!==!1&&!C.getQueryCache().find(q(h,"query"))&&g(h,v);const y=o(h,"query",v),w=v?.trpc?.abortOnUnmount??t?.abortOnUnmount??m,O=En({...y,queryKey:q(h,"query"),queryFn:x=>{const R={...y,trpc:{...y?.trpc,...w?{signal:x.signal}:{}}};return E.query(...k(h,R))},context:n});return O.trpc=Re({path:h[0]}),O}function c(h,v){const{client:b}=u(),m=Oe({context:n}),E=Array.isArray(h)?h[0]:h,S=xn({...v,mutationKey:[E.split(".")],mutationFn:C=>b.mutation(...k([E,C],v)),context:n,onSuccess(...C){return e({originalFn:()=>v?.onSuccess?.(...C),queryClient:m,meta:v?.meta??{}})}});return S.trpc=Re({path:E}),S}/* istanbul ignore next -- @preserve */function l(h,v){const b=v?.enabled??!0,m=K(h),{client:E}=u(),S=P.useRef(v);return S.current=v,P.useEffect(()=>{if(!b)return;const[C,g]=h;let y=!1;const w=E.subscription(C,g??void 0,{onStarted:()=>{y||S.current.onStarted?.()},onData:O=>{y||S.current.onData(O)},onError:O=>{y||S.current.onError?.(O)}});return()=>{y=!0,w.unsubscribe()}},[m,b])}function d(h,v){const[b,m]=h,{client:E,ssrState:S,prefetchInfiniteQuery:C,queryClient:g,abortOnUnmount:y}=u();typeof window>"u"&&S==="prepass"&&v?.trpc?.ssr!==!1&&v?.enabled!==!1&&!g.getQueryCache().find(q(h,"infinite"))&&C(h,v);const w=o(h,"infinite",v),O=v?.trpc?.abortOnUnmount??y,x=qn({...w,queryKey:q(h,"infinite"),queryFn:R=>{const I={...w,trpc:{...w?.trpc,...O?{signal:R.signal}:{}}},ce={...m??{},cursor:R.pageParam??v?.initialCursor};return E.query(...k([b,ce],I))},context:n});return x.trpc=Re({path:b}),x}return{Provider:i,createClient:s,useContext:u,useQuery:a,useQueries:(h,v)=>{const{ssrState:b,queryClient:m,prefetchQuery:E,client:S}=u(),C=Dn(S),g=h(C);if(typeof window>"u"&&b==="prepass")for(const y of g){const w=y;w.trpc?.ssr!==!1&&!m.getQueryCache().find(q(w.queryKey,"query"))&&E(w.queryKey,w)}return Rn({queries:g.map(y=>({...y,queryKey:q(y.queryKey,"query")})),context:v})},useMutation:c,useSubscription:l,useDehydratedState:(h,v)=>P.useMemo(()=>v&&h.runtime.transformer.deserialize(v),[v,h]),useInfiniteQuery:d}}function kn(t){return Fn(t)}function _n(t){return Ye(e=>e==="useContext"?()=>{const r=t.useContext();return P.useMemo(()=>Mn(r),[r])}:t.hasOwnProperty(e)?t[e]:In(e,t))}function Un(t){const e=kn(t);return _n(e)}var jn=function(){function t(){this.keyToValue=new Map,this.valueToKey=new Map}return t.prototype.set=function(e,r){this.keyToValue.set(e,r),this.valueToKey.set(r,e)},t.prototype.getByKey=function(e){return this.keyToValue.get(e)},t.prototype.getByValue=function(e){return this.valueToKey.get(e)},t.prototype.clear=function(){this.keyToValue.clear(),this.valueToKey.clear()},t}(),nr=function(){function t(e){this.generateIdentifier=e,this.kv=new jn}return t.prototype.register=function(e,r){this.kv.getByValue(e)||(r||(r=this.generateIdentifier(e)),this.kv.set(r,e))},t.prototype.clear=function(){this.kv.clear()},t.prototype.getIdentifier=function(e){return this.kv.getByValue(e)},t.prototype.getValue=function(e){return this.kv.getByKey(e)},t}(),Kn=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Nn=function(t){Kn(e,t);function e(){var r=t.call(this,function(n){return n.name})||this;return r.classToAllowedProps=new Map,r}return e.prototype.register=function(r,n){typeof n=="object"?(n.allowProps&&this.classToAllowedProps.set(r,n.allowProps),t.prototype.register.call(this,r,n.identifier)):t.prototype.register.call(this,r,n)},e.prototype.getAllowedProps=function(r){return this.classToAllowedProps.get(r)},e}(nr),Ln=globalThis&&globalThis.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],u;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(o){u={error:o}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return i};function Bn(t){if("values"in Object)return Object.values(t);var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);return e}function $n(t,e){var r=Bn(t);if("find"in r)return r.find(e);for(var n=r,s=0;s<n.length;s++){var i=n[s];if(e(i))return i}}function X(t,e){Object.entries(t).forEach(function(r){var n=Ln(r,2),s=n[0],i=n[1];return e(i,s)})}function fe(t,e){return t.indexOf(e)!==-1}function pt(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e(n))return n}}var zn=function(){function t(){this.transfomers={}}return t.prototype.register=function(e){this.transfomers[e.name]=e},t.prototype.findApplicable=function(e){return $n(this.transfomers,function(r){return r.isApplicable(e)})},t.prototype.findByName=function(e){return this.transfomers[e]},t}(),Vn=function(t){return Object.prototype.toString.call(t).slice(8,-1)},sr=function(t){return typeof t>"u"},Hn=function(t){return t===null},re=function(t){return typeof t!="object"||t===null||t===Object.prototype?!1:Object.getPrototypeOf(t)===null?!0:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype},Ue=function(t){return re(t)&&Object.keys(t).length===0},L=function(t){return Array.isArray(t)},Wn=function(t){return typeof t=="string"},Gn=function(t){return typeof t=="number"&&!isNaN(t)},Xn=function(t){return typeof t=="boolean"},Yn=function(t){return t instanceof RegExp},ne=function(t){return t instanceof Map},se=function(t){return t instanceof Set},ir=function(t){return Vn(t)==="Symbol"},Zn=function(t){return t instanceof Date&&!isNaN(t.valueOf())},Jn=function(t){return t instanceof Error},vt=function(t){return typeof t=="number"&&isNaN(t)},mt=function(t){return Xn(t)||Hn(t)||sr(t)||Gn(t)||Wn(t)||ir(t)},es=function(t){return typeof t=="bigint"},ts=function(t){return t===1/0||t===-1/0},rs=function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},ns=function(t){return t instanceof URL},ur=function(t){return t.replace(/\./g,"\\.")},Ee=function(t){return t.map(String).map(ur).join(".")},J=function(t){for(var e=[],r="",n=0;n<t.length;n++){var s=t.charAt(n),i=s==="\\"&&t.charAt(n+1)===".";if(i){r+=".",n++;continue}var u=s===".";if(u){e.push(r),r="";continue}r+=s}var o=r;return e.push(o),e},je=globalThis&&globalThis.__assign||function(){return je=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},je.apply(this,arguments)},Ke=globalThis&&globalThis.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],u;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(o){u={error:o}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return i},Ne=globalThis&&globalThis.__spreadArray||function(t,e){for(var r=0,n=e.length,s=t.length;r<n;r++,s++)t[s]=e[r];return t};function M(t,e,r,n){return{isApplicable:t,annotation:e,transform:r,untransform:n}}var or=[M(sr,"undefined",function(){return null},function(){}),M(es,"bigint",function(t){return t.toString()},function(t){return typeof BigInt<"u"?BigInt(t):(console.error("Please add a BigInt polyfill."),t)}),M(Zn,"Date",function(t){return t.toISOString()},function(t){return new Date(t)}),M(Jn,"Error",function(t,e){var r={name:t.name,message:t.message};return e.allowedErrorProps.forEach(function(n){r[n]=t[n]}),r},function(t,e){var r=new Error(t.message);return r.name=t.name,r.stack=t.stack,e.allowedErrorProps.forEach(function(n){r[n]=t[n]}),r}),M(Yn,"regexp",function(t){return""+t},function(t){var e=t.slice(1,t.lastIndexOf("/")),r=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,r)}),M(se,"set",function(t){return Ne([],Ke(t.values()))},function(t){return new Set(t)}),M(ne,"map",function(t){return Ne([],Ke(t.entries()))},function(t){return new Map(t)}),M(function(t){return vt(t)||ts(t)},"number",function(t){return vt(t)?"NaN":t>0?"Infinity":"-Infinity"},Number),M(function(t){return t===0&&1/t===-1/0},"number",function(){return"-0"},Number),M(ns,"URL",function(t){return t.toString()},function(t){return new URL(t)})];function Pe(t,e,r,n){return{isApplicable:t,annotation:e,transform:r,untransform:n}}var ar=Pe(function(t,e){if(ir(t)){var r=!!e.symbolRegistry.getIdentifier(t);return r}return!1},function(t,e){var r=e.symbolRegistry.getIdentifier(t);return["symbol",r]},function(t){return t.description},function(t,e,r){var n=r.symbolRegistry.getValue(e[1]);if(!n)throw new Error("Trying to deserialize unknown symbol");return n}),ss=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce(function(t,e){return t[e.name]=e,t},{}),cr=Pe(rs,function(t){return["typed-array",t.constructor.name]},function(t){return Ne([],Ke(t))},function(t,e){var r=ss[e[1]];if(!r)throw new Error("Trying to deserialize unknown typed array");return new r(t)});function lr(t,e){if(t?.constructor){var r=!!e.classRegistry.getIdentifier(t.constructor);return r}return!1}var fr=Pe(lr,function(t,e){var r=e.classRegistry.getIdentifier(t.constructor);return["class",r]},function(t,e){var r=e.classRegistry.getAllowedProps(t.constructor);if(!r)return je({},t);var n={};return r.forEach(function(s){n[s]=t[s]}),n},function(t,e,r){var n=r.classRegistry.getValue(e[1]);if(!n)throw new Error("Trying to deserialize unknown class - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564");return Object.assign(Object.create(n.prototype),t)}),hr=Pe(function(t,e){return!!e.customTransformerRegistry.findApplicable(t)},function(t,e){var r=e.customTransformerRegistry.findApplicable(t);return["custom",r.name]},function(t,e){var r=e.customTransformerRegistry.findApplicable(t);return r.serialize(t)},function(t,e,r){var n=r.customTransformerRegistry.findByName(e[1]);if(!n)throw new Error("Trying to deserialize unknown custom value");return n.deserialize(t)}),is=[fr,ar,hr,cr],bt=function(t,e){var r=pt(is,function(s){return s.isApplicable(t,e)});if(r)return{value:r.transform(t,e),type:r.annotation(t,e)};var n=pt(or,function(s){return s.isApplicable(t,e)});if(n)return{value:n.transform(t,e),type:n.annotation}},dr={};or.forEach(function(t){dr[t.annotation]=t});var us=function(t,e,r){if(L(e))switch(e[0]){case"symbol":return ar.untransform(t,e,r);case"class":return fr.untransform(t,e,r);case"custom":return hr.untransform(t,e,r);case"typed-array":return cr.untransform(t,e,r);default:throw new Error("Unknown transformation: "+e)}else{var n=dr[e];if(!n)throw new Error("Unknown transformation: "+e);return n.untransform(t,r)}},W=function(t,e){for(var r=t.keys();e>0;)r.next(),e--;return r.next().value};function yr(t){if(fe(t,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(fe(t,"prototype"))throw new Error("prototype is not allowed as a property");if(fe(t,"constructor"))throw new Error("constructor is not allowed as a property")}var os=function(t,e){yr(e);for(var r=0;r<e.length;r++){var n=e[r];if(se(t))t=W(t,+n);else if(ne(t)){var s=+n,i=+e[++r]==0?"key":"value",u=W(t,s);switch(i){case"key":t=u;break;case"value":t=t.get(u);break}}else t=t[n]}return t},Le=function(t,e,r){if(yr(e),e.length===0)return r(t);for(var n=t,s=0;s<e.length-1;s++){var i=e[s];if(L(n)){var u=+i;n=n[u]}else if(re(n))n=n[i];else if(se(n)){var o=+i;n=W(n,o)}else if(ne(n)){var a=s===e.length-2;if(a)break;var o=+i,c=+e[++s]==0?"key":"value",l=W(n,o);switch(c){case"key":n=l;break;case"value":n=n.get(l);break}}}var d=e[e.length-1];if(L(n)?n[+d]=r(n[+d]):re(n)&&(n[d]=r(n[d])),se(n)){var p=W(n,+d),f=r(p);p!==f&&(n.delete(p),n.add(f))}if(ne(n)){var o=+e[e.length-2],h=W(n,o),c=+d==0?"key":"value";switch(c){case"key":{var v=r(h);n.set(v,n.get(h)),v!==h&&n.delete(h);break}case"value":{n.set(h,r(n.get(h)));break}}}return t},D=globalThis&&globalThis.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],u;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(o){u={error:o}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return i},N=globalThis&&globalThis.__spreadArray||function(t,e){for(var r=0,n=e.length,s=t.length;r<n;r++,s++)t[s]=e[r];return t};function Be(t,e,r){if(r===void 0&&(r=[]),!!t){if(!L(t)){X(t,function(u,o){return Be(u,e,N(N([],D(r)),D(J(o))))});return}var n=D(t,2),s=n[0],i=n[1];i&&X(i,function(u,o){Be(u,e,N(N([],D(r)),D(J(o))))}),e(s,r)}}function as(t,e,r){return Be(e,function(n,s){t=Le(t,s,function(i){return us(i,n,r)})}),t}function cs(t,e){function r(u,o){var a=os(t,J(o));u.map(J).forEach(function(c){t=Le(t,c,function(){return a})})}if(L(e)){var n=D(e,2),s=n[0],i=n[1];s.forEach(function(u){t=Le(t,J(u),function(){return t})}),i&&X(i,r)}else X(e,r);return t}var ls=function(t,e){return re(t)||L(t)||ne(t)||se(t)||lr(t,e)};function fs(t,e,r){var n=r.get(t);n?n.push(e):r.set(t,[e])}function hs(t){var e={},r=void 0;return t.forEach(function(n){if(!(n.length<=1)){var s=D(n.map(function(o){return o.map(String)}).sort(function(o,a){return o.length-a.length})),i=s[0],u=s.slice(1);i.length===0?r=u.map(Ee):e[Ee(i)]=u.map(Ee)}}),r?Ue(e)?[r]:[r,e]:Ue(e)?void 0:e}var pr=function(t,e,r,n,s){var i;if(n===void 0&&(n=[]),s===void 0&&(s=[]),mt(t)||fs(t,n,e),!ls(t,r)){var u=bt(t,r);return u?{transformedValue:u.value,annotations:[u.type]}:{transformedValue:t}}if(fe(s,t))return{transformedValue:null};var o=bt(t,r),a=(i=o?.value)!==null&&i!==void 0?i:t;mt(t)||(s=N(N([],D(s)),[t]));var c=L(a)?[]:{},l={};return X(a,function(d,p){var f=pr(d,e,r,N(N([],D(n)),[p]),s);c[p]=f.transformedValue,L(f.annotations)?l[p]=f.annotations:re(f.annotations)&&X(f.annotations,function(h,v){l[ur(p)+"."+v]=h})}),Ue(l)?{transformedValue:c,annotations:o?[o.type]:void 0}:{transformedValue:c,annotations:o?[o.type,l]:l}};function vr(t){return Object.prototype.toString.call(t).slice(8,-1)}function ds(t){if(vr(t)!=="Object")return!1;const e=Object.getPrototypeOf(t);return e.constructor===Object&&e===Object.prototype}function gt(t){return vr(t)==="Array"}function ys(t,e,r,n,s){const i={}.propertyIsEnumerable.call(n,e)?"enumerable":"nonenumerable";i==="enumerable"&&(t[e]=r),s&&i==="nonenumerable"&&Object.defineProperty(t,e,{value:r,enumerable:!1,writable:!0,configurable:!0})}function $e(t,e={}){if(gt(t))return t.map(s=>$e(s,e));if(!ds(t))return t;const r=Object.getOwnPropertyNames(t),n=Object.getOwnPropertySymbols(t);return[...r,...n].reduce((s,i)=>{if(gt(e.props)&&!e.props.includes(i))return s;const u=t[i],o=$e(u,e);return ys(s,i,o,t,e.nonenumerable),s},{})}var B=globalThis&&globalThis.__assign||function(){return B=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},B.apply(this,arguments)},ps=globalThis&&globalThis.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],u;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(o){u={error:o}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return i},vs=globalThis&&globalThis.__spreadArray||function(t,e){for(var r=0,n=e.length,s=t.length;r<n;r++,s++)t[s]=e[r];return t},F=function(){function t(){this.classRegistry=new Nn,this.symbolRegistry=new nr(function(e){var r;return(r=e.description)!==null&&r!==void 0?r:""}),this.customTransformerRegistry=new zn,this.allowedErrorProps=[]}return t.prototype.serialize=function(e){var r=new Map,n=pr(e,r,this),s={json:n.transformedValue};n.annotations&&(s.meta=B(B({},s.meta),{values:n.annotations}));var i=hs(r);return i&&(s.meta=B(B({},s.meta),{referentialEqualities:i})),s},t.prototype.deserialize=function(e){var r=e.json,n=e.meta,s=$e(r);return n?.values&&(s=as(s,n.values,this)),n?.referentialEqualities&&(s=cs(s,n.referentialEqualities)),s},t.prototype.stringify=function(e){return JSON.stringify(this.serialize(e))},t.prototype.parse=function(e){return this.deserialize(JSON.parse(e))},t.prototype.registerClass=function(e,r){this.classRegistry.register(e,r)},t.prototype.registerSymbol=function(e,r){this.symbolRegistry.register(e,r)},t.prototype.registerCustom=function(e,r){this.customTransformerRegistry.register(B({name:r},e))},t.prototype.allowErrorProps=function(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];(e=this.allowedErrorProps).push.apply(e,vs([],ps(r)))},t.defaultInstance=new t,t.serialize=t.defaultInstance.serialize.bind(t.defaultInstance),t.deserialize=t.defaultInstance.deserialize.bind(t.defaultInstance),t.stringify=t.defaultInstance.stringify.bind(t.defaultInstance),t.parse=t.defaultInstance.parse.bind(t.defaultInstance),t.registerClass=t.defaultInstance.registerClass.bind(t.defaultInstance),t.registerSymbol=t.defaultInstance.registerSymbol.bind(t.defaultInstance),t.registerCustom=t.defaultInstance.registerCustom.bind(t.defaultInstance),t.allowErrorProps=t.defaultInstance.allowErrorProps.bind(t.defaultInstance),t}();F.serialize;F.deserialize;F.stringify;F.parse;F.registerClass;F.registerCustom;F.registerSymbol;F.allowErrorProps;const ms=F;function wt(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function bs(t,e){if(t){if(typeof t=="string")return wt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wt(t,e)}}function gs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=bs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(a){throw a},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(t)},n:function(){var a=r.next();return i=a.done,a},e:function(a){u=!0,o=a},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function ws(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Os(t,e,r){return e&&Ot(t.prototype,e),r&&Ot(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ps(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Pt=function(){function t(){ws(this,t),Ps(this,"listeners",new Set),this.emit=this.emit.bind(this)}return Os(t,[{key:"clear",value:function(){this.listeners.clear()}},{key:"add",value:function(r){var n=this;return this.listeners.add(r),function(){return n.remove(r)}}},{key:"remove",value:function(r){this.listeners.delete(r)}},{key:"emit",value:function(r){var n=gs(this.listeners),s;try{for(n.s();!(s=n.n()).done;){var i=s.value;i(r)}}catch(u){n.e(u)}finally{n.f()}}}]),t}();function St(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ss(t,e){if(t){if(typeof t=="string")return St(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return St(t,e)}}function Cs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Ss(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(a){throw a},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(t)},n:function(){var a=r.next();return i=a.done,a},e:function(a){u=!0,o=a},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function Rs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Es(t,e,r){return e&&Ct(t.prototype,e),r&&Ct(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mr;mr=Symbol.iterator;var xs=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Rs(this,t),xe(this,"onEntityAdded",new Pt),xe(this,"onEntityRemoved",new Pt),xe(this,"entityPositions",new Map),this.entities=e,this.add=this.add.bind(this),this.remove=this.remove.bind(this);for(var r=0;r<e.length;r++)this.entityPositions.set(e[r],r)}return Es(t,[{key:mr,value:function(){var r=this,n=this.entities.length;return{next:function(){var i=r.entities[--n];return{value:i,done:n<0}}}}},{key:"size",get:function(){return this.entities.length}},{key:"has",value:function(r){return this.entityPositions.has(r)}},{key:"add",value:function(r){return r&&!this.has(r)&&(this.entities.push(r),this.entityPositions.set(r,this.entities.length-1),this.onEntityAdded.emit(r)),r}},{key:"remove",value:function(r){if(this.has(r)){this.onEntityRemoved.emit(r);var n=this.entityPositions.get(r);this.entityPositions.delete(r);var s=this.entities[this.entities.length-1];s!==r&&(this.entities[n]=s,this.entityPositions.set(s,n)),this.entities.pop()}return r}},{key:"clear",value:function(){var r=Cs(this),n;try{for(r.s();!(n=r.n()).done;){var s=n.value;this.remove(s)}}catch(i){r.e(i)}finally{r.f()}}}]),t}();function ze(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Qs(t){if(Array.isArray(t))return ze(t)}function qs(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function br(t,e){if(t){if(typeof t=="string")return ze(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ze(t,e)}}function Is(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ve(t){return Qs(t)||qs(t)||br(t)||Is()}function He(t){return He=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(t)}function he(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=br(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(a){throw a},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){r=r.call(t)},n:function(){var a=r.next();return i=a.done,a},e:function(a){u=!0,o=a},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(u)throw o}}}}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Z(t,e,r){return e&&Rt(t.prototype,e),r&&Rt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function We(t,e){return We=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},We(t,e)}function ue(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&We(t,e)}function me(t){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},me(t)}function As(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ts(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ee(t)}function oe(t){var e=As();return function(){var n=me(t),s;if(e){var i=me(this).constructor;s=Reflect.construct(n,arguments,i)}else s=n.apply(this,arguments);return Ts(this,s)}}function $(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var gr=function(){function t(){Y(this,t),$(this,"cache",new Map)}return Z(t,[{key:"get",value:function(r,n){var s=this.cache.get(r);return s===void 0&&(this.cache.set(r,n),s=n),s}}]),t}();function Ms(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return r.every(function(s){return t[s]!==void 0})}function Ds(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return r.every(function(s){return t[s]===void 0})}new gr;var Et=function(e){return Ve(new Set(e.sort().filter(function(r){return!!r&&r!==""})))},Fs=function(e){return{with:e.with!==void 0?Et(e.with):[],without:e.without!==void 0?Et(e.without):[]}},ks=new gr,_s=function(e){var r=Fs(e),n=JSON.stringify(r);return ks.get(n,r)},wr=function(t){ue(r,t);var e=oe(r);function r(){var n;Y(this,r);for(var s=arguments.length,i=new Array(s),u=0;u<s;u++)i[u]=arguments[u];return n=e.call.apply(e,[this].concat(i)),$(ee(n),"buckets",new Set),n}return Z(r,[{key:"wants",value:function(s){return!0}},{key:"evaluate",value:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s;if(this.wants(i)?this.add(s):this.remove(s),this.has(s)){var u=he(this.buckets),o;try{for(u.s();!(o=u.n()).done;){var a=o.value;a.evaluate(s,i)}}catch(c){u.e(c)}finally{u.f()}}}},{key:"where",value:function(s){var i=this,u=this.entities.length,o=function(){var c;do c=i.entities[--u];while(c&&!s(c));return{value:c,done:u<0}};return $({},Symbol.iterator,function(){return{next:o}})}},{key:"with",value:function(){return this.archetype.apply(this,arguments)}},{key:"without",value:function(){for(var s=arguments.length,i=new Array(s),u=0;u<s;u++)i[u]=arguments[u];return this.archetype({without:i})}},{key:"archetype",value:function(s){if(typeof s=="function"){var i=he(this.buckets),u;try{for(i.s();!(u=i.n()).done;){var o=u.value;if(o instanceof xt&&o.predicate===s)return o}}catch(m){i.e(m)}finally{i.f()}var a=new xt(this,s);return this.buckets.add(a),a}if(He(s)!=="object"){for(var c=arguments.length,l=new Array(c>1?c-1:0),d=1;d<c;d++)l[d-1]=arguments[d];return this.archetype({with:[s].concat(l)})}var p=_s(s),f=he(this.buckets),h;try{for(f.s();!(h=f.n()).done;){var v=h.value;if(v instanceof Qt&&v.query===p)return v}}catch(m){f.e(m)}finally{f.f()}var b=new Qt(this,p);return this.buckets.add(b),b}}]),r}(xs),Or=function(t){ue(r,t);var e=oe(r);function r(n){var s;return Y(this,r),s=e.call(this),s.source=n,s}return Z(r,[{key:"startUpdating",value:function(){var s=this;this.source.onEntityAdded.add(function(i){s.wants(i)&&s.add(i)}),this.source.onEntityRemoved.add(function(i){s.remove(i)}),this.update()}},{key:"update",value:function(){var s=he(this.source),i;try{for(s.s();!(i=s.n()).done;){var u=i.value;this.evaluate(u)}}catch(o){s.e(o)}finally{s.f()}}}]),r}(wr),xt=function(t){ue(r,t);var e=oe(r);function r(n,s){var i;return Y(this,r),i=e.call(this,n),i.source=n,i.predicate=s,i.startUpdating(),i}return Z(r,[{key:"wants",value:function(s){return this.predicate(s)}}]),r}(Or),Qt=function(t){ue(r,t);var e=oe(r);function r(n,s){var i;return Y(this,r),i=e.call(this,n),i.source=n,i.query=s,i.startUpdating(),i}return Z(r,[{key:"wants",value:function(s){return Ms.apply(void 0,[s].concat(Ve(this.query.with||[])))&&Ds.apply(void 0,[s].concat(Ve(this.query.without||[])))}}]),r}(Or);function qt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Us(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qt(Object(r),!0).forEach(function(n){$(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qt(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var js=function(t){ue(r,t);var e=oe(r);function r(){var n,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Y(this,r),n=e.call(this,s),$(ee(n),"entityToId",new Map),$(ee(n),"idToEntity",new Map),$(ee(n),"nextId",0),n.onEntityRemoved.add(function(i){if(n.entityToId.has(i)){var u=n.entityToId.get(i);n.idToEntity.delete(u),n.entityToId.delete(i)}}),n}return Z(r,[{key:"update",value:function(n){function s(i,u,o){return n.apply(this,arguments)}return s.toString=function(){return n.toString()},s}(function(n,s,i){if(typeof s=="function"){var u=s(n);u&&Object.assign(n,u)}else typeof s=="string"?n[s]=i:s&&Object.assign(n,s);return this.has(n)&&this.evaluate(n),n})},{key:"addComponent",value:function(s,i,u){s[i]===void 0&&(s[i]=u,this.has(s)&&this.evaluate(s))}},{key:"removeComponent",value:function(s,i){if(s[i]!==void 0){if(this.has(s)){var u=Us({},s);delete u[i],this.evaluate(s,u)}delete s[i]}}},{key:"id",value:function(s){if(this.has(s)){if(!this.entityToId.has(s)){var i=this.nextId++;this.entityToId.set(s,i),this.idToEntity.set(i,s)}return this.entityToId.get(s)}}},{key:"entity",value:function(s){return this.idToEntity.get(s)}}]),r}(wr);const U=new js,j=new Map;U.onEntityAdded.add(t=>{j.set(t.id,t)});U.onEntityRemoved.add(t=>{j.delete(t.id)});const Ks=(t,e=1e4)=>{const r=j.get(t);return r?Promise.resolve(r):new Promise((n,s)=>{const i=U.onEntityAdded.add(o=>{o.id===t&&(n(o),i(),clearTimeout(u))}),u=setTimeout(()=>{s(new Error("timed out waiting for entity "+t)),i()},e)})},Ns=async(t,e,r=1e4)=>{const n=await Ks(t,r);return e(n)?Promise.resolve(n):new Promise((s,i)=>{const u=n.subscribe(a=>{e(n)&&(clearTimeout(o),s(n),u())}),o=setTimeout(()=>{u(),i(new Error("timed out waiting for entity"+n.id))},r)})},be=Un();var Pr={exports:{}},Sr={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ae=P;function Ls(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Bs=typeof Object.is=="function"?Object.is:Ls,$s=ae.useSyncExternalStore,zs=ae.useRef,Vs=ae.useEffect,Hs=ae.useMemo,Ws=ae.useDebugValue;Sr.useSyncExternalStoreWithSelector=function(t,e,r,n,s){var i=zs(null);if(i.current===null){var u={hasValue:!1,value:null};i.current=u}else u=i.current;i=Hs(function(){function a(f){if(!c){if(c=!0,l=f,f=n(f),s!==void 0&&u.hasValue){var h=u.value;if(s(h,f))return d=h}return d=f}if(h=d,Bs(l,f))return h;var v=n(f);return s!==void 0&&s(h,v)?h:(l=f,d=v)}var c=!1,l,d,p=r===void 0?null:r;return[function(){return a(e())},p===null?void 0:function(){return a(p())}]},[e,r,n,s]);var o=$s(t,i[0],i[1]);return Vs(function(){u.hasValue=!0,u.value=o},[o]),Ws(o),o};Pr.exports=Sr;var Gs=Pr.exports,Xs=Object.defineProperty,It=Object.getOwnPropertySymbols,Ys=Object.prototype.hasOwnProperty,Zs=Object.prototype.propertyIsEnumerable,At=(t,e,r)=>e in t?Xs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Js=(t,e)=>{for(var r in e||={})Ys.call(e,r)&&At(t,r,e[r]);if(It)for(var r of It(e))Zs.call(e,r)&&At(t,r,e[r]);return t},ei=(t,e,r)=>new Promise((n,s)=>{var i=a=>{try{o(r.next(a))}catch(c){s(c)}},u=a=>{try{o(r.throw(a))}catch(c){s(c)}},o=a=>a.done?n(a.value):Promise.resolve(a.value).then(i,u);o((r=r.apply(t,e)).next())});const ti=P.createContext({}),ri=({children:t})=>{const{client:e}=be.useContext();window.$WORLD=U;const[r]=P.useState(new Map),n=P.useCallback(i=>{const u=i.id,o=new Set,a=p=>ei(void 0,null,function*(){l({type:"SEND_TRIGGER",command:p}),yield e.entity.send.mutate(p),l({type:"SEND_COMPLETE",command:p})}),c=p=>(o.add(p),()=>{o.delete(p)}),l=p=>{for(const f of o)f(p)};return r.set(u,l),Js({send:a,subscribe:c},i)},[e,r]);P.useEffect(()=>e.entity.list.subscribe(void 0,{onError(u){console.error(u)},onData(u){if(u.type==="ADDED")for(const o of u.entities){const a=n(o);j.set(o.id,a),U.add(a)}else if(u.type==="REMOVED")for(const o of u.entities){const a=j.get(o.id);if(!a){console.error("missing entity when trying to remove");return}U.remove(a)}else if(u.type==="CHANGED")for(const o of u.changedEntities){const a=j.get(o.id);if(!a){console.error("missing entity when trying to apply patches");return}U.update(a,Cr(a,o.patches));const c=r.get(a.id);if(!c)throw new Error("expected next function for entity "+a.id);c({type:"CHANGE",patches:o.patches})}}}).unsubscribe,[e,n,r]);const s=(i,u)=>{const o=()=>{const c=j.get(i);if(!c)throw new Error("entity missing: "+c);return c},a=c=>{const l=j.get(i);if(!l)throw new Error("entity missing: "+l);const d=l.subscribe(c);return()=>{d()}};return Gs.useSyncExternalStoreWithSelector(a,o,o,u)};return V.jsx(ti.Provider,{value:{world:U,useEntitySelector:s},children:t})};var ni=(t,e,r)=>new Promise((n,s)=>{var i=a=>{try{o(r.next(a))}catch(c){s(c)}},u=a=>{try{o(r.throw(a))}catch(c){s(c)}},o=a=>a.done?n(a.value):Promise.resolve(a.value).then(i,u);o((r=r.apply(t,e)).next())});Rr();const ai=({children:t,trpcUrl:e})=>{console.log("render");const[r]=P.useState(()=>new on({defaultOptions:{queries:{refetchOnWindowFocus:!1}}})),n=jr({url:e}),[s]=P.useState(()=>be.createClient({transformer:ms,links:[_r({enabled:i=>!0}),Kr({client:n})]}));return V.jsx(be.Provider,{client:s,queryClient:r,children:V.jsx(Pn,{client:r,children:V.jsx(ri,{children:V.jsx(ii,{children:t})})})})},si=P.createContext({}),ii=P.memo(({children:t})=>{const e=P.useRef(!1),{client:r}=be.useContext(),[n,s]=P.useState();return P.useLayoutEffect(()=>{if(e.current)return;e.current=!0;let i;const u=localStorage.getItem("refreshToken")||void 0,o=localStorage.getItem("accessToken")||void 0,a=localStorage.getItem("deviceId")||void 0,c=u&&o?{refreshToken:u,accessToken:o}:void 0;return r.connection.initialize.mutate({deviceId:a,authTokens:c,initialLocation:window.location.href}).then(l=>ni(void 0,null,function*(){const d=yield Ns(l,p=>p.states.Initialized==="True");localStorage.setItem("refreshToken",d.authTokens.refreshToken),localStorage.setItem("accessToken",d.authTokens.accessToken),localStorage.setItem("deviceId",d.deviceId),s(l)})),()=>{clearInterval(i)}},[r]),V.jsx(si.Provider,{value:{myConnectionId:n},children:t})});export{ai as ApplicationProvider};
